{"vulnerability":"close_remainder_to","smart_contract":"from pyteal import *\n\nmax_fee = Int(10000)  \nreceiver_a = Addr(\"V5MLNKEULQMEHXVO5VER6PVQNJIJEDADJESVPY7URW6DRJXGCMVRQWUER4\")\nreceiver_b = Addr(\"XQ6ZC5QKILOPUON2LZDRZGUW4W5SD6O4SFHWJ7K4HHS3K2IMCDTMBX7TVY\")\nreceiver_c = Addr(\"LBMVADTYAGKLA664UVRSW2JABSFCHGIDWXB5TTKPMYWY5FR7XVRNDQIKDM\")\nmin_amount_a = Int(300) \nmin_amount_b = Int(600)  \nmin_amount_c = Int(900)  \ntimeout_round = Int(10000)  \nextra_fee = Int(500)\n\n\ndef messy_multi_sig_payment():\n    \n    program_logic = And(\n        Txn.type_enum() == TxnType.Payment,\n        Txn.fee() <= max_fee,\n        Txn.rekey_to() == Global.zero_address(),\n        Gtxn[0].type_enum() == TxnType.Payment,\n        Gtxn[0].receiver() == receiver_a,\n        Gtxn[0].amount() >= min_amount_a,\n        Gtxn[0].close_remainder_to() == Global.zero_address(),\n        Gtxn[0].rekey_to() == Global.zero_address(),\n        Gtxn[0].fee() + extra_fee <= max_fee, \n\n        Gtxn[1].type_enum() == TxnType.Payment,\n        Gtxn[1].receiver() == receiver_b,\n        Gtxn[1].amount() >= min_amount_b,\n        Gtxn[1].rekey_to() == Global.zero_address(),\n        Gtxn[1].first_valid() < timeout_round, \n\n        Gtxn[2].type_enum() == TxnType.AssetTransfer, \n        Gtxn[2].fee() <= Int(1000), \n        Gtxn[2].rekey_to() == Global.zero_address(),  \n        Gtxn[2].xfer_asset() == Gtxn[1].xfer_asset(),  \n        Gtxn[2].asset_amount() >= Int(10),  \n        Gtxn[2].receiver() == receiver_c,  \n        Gtxn[2].asset_close_to == Global.zero_address(),  \n\n        Txn.sender() == Addr(\"LBMVADTYAGKLA664UVRSW2JABSFCHGIDWXB5TTKPMYWY5FR7XVRNDQIKDM\"),\n\n        Txn.first_valid() > timeout_round,\n        Txn.receiver() == Global.zero_address(),\n        Txn.amount() == Int(0),\n        Txn.rekey_to() == Global.zero_address(),\n        Txn.lease() == Bytes(\"base64\", \"timeoutLease\"), \n    )\n\n    return program_logic\n\n\nif __name__ == '__main__':\n    print(compileTeal(messy_multi_sig_payment(), mode=Mode.Signature, version=5))\n"}
