{"vulnerability":"no vuln","smart_contract":"from pyteal import *\n\ntmpl_fee = Int(1000) #set the maximum transaction fee\ntmpl_asset_id_1 = Int(111111)\ntmpl_asset_id_2 = Int(222222)\ntmpl_amount_1 = Int(5000)\ntmpl_amount_2 = Int(3000)\ntmpl_receiver_1 = Addr(\"5TWROOV6WRXEM7YQGA2VBN4VNVXSLGMESBZVP3RAYMYXUWZU7EWDB7OBMU\")\ntmpl_receiver_2 = Addr(\"BN2R5VU5TF2U7JM4DDYN4UGJBPGO7CMCKAPCRSPAD6KXBJLWP53JCDFLG4\")\ntmpl_start_time = Int(5000) \ntmpl_end_time = Int(10000) \n\ndef advanced_two_asset_transfers():\n   \n    group_size_check = Global.group_size() == Int(2)\n   \n    time_check = And(\n        Global.latest_timestamp() >= tmpl_start_time,\n        Global.latest_timestamp() <= tmpl_end_time,\n    )\n\n    \n    txn_0 = And(\n        Gtxn[0].type_enum() == TxnType.AssetTransfer,\n        Gtxn[0].fee() <= tmpl_fee,\n        Gtxn[0].xfer_asset() == tmpl_asset_id_1,\n        Gtxn[0].asset_receiver() == tmpl_receiver_1,\n        Gtxn[0].asset_amount() == tmpl_amount_1,\n        Gtxn[0].note() == Bytes(\"Transfer1\"),  \n        Gtxn[0].asset_close_to() == Global.zero_address(),\n        Gtxn[0].rekey_to() == Global.zero_address(),\n    )\n\n    \n    txn_1 = And(\n        Gtxn[1].type_enum() == TxnType.AssetTransfer,\n        Gtxn[1].fee() <= tmpl_fee,\n        Gtxn[1].xfer_asset() == tmpl_asset_id_2,\n        Gtxn[1].asset_receiver() == tmpl_receiver_2,\n        Gtxn[1].asset_close_to() == Global.zero_address(),\n        If(\n            Global.latest_timestamp() % Int(2) == Int(0),\n            Gtxn[1].asset_amount() == tmpl_amount_2,\n            Gtxn[1].asset_amount() == tmpl_amount_2 + Int(1000),  \n        ),\n\n        Gtxn[1].rekey_to() == Global.zero_address(),\n    )\n\n \n    program = And(\n        group_size_check,\n        time_check,\n        txn_0,\n        txn_1,\n    )\n\n    return program\n\n\nif __name__ == \"__main__\":\n    print(compileTeal(advanced_two_asset_transfers(), mode=Mode.Signature, version=3))"}
