{"vulnerability":"Unchecked_Asset_Receiver","smart_contract":"from pyteal import *\n\ndef asset_management_contract():\n    min_amount = Int(100)\n    key_prefix = Bytes(\"asset_\")\n    creator_key = Bytes(\"Creator\")\n\n    on_creation = Seq([\n        App.globalPut(creator_key, Txn.sender()),\n        Return(Int(1))\n    ])\n\n    on_optin = Return(Int(1))\n\n    on_closeout = Return(Int(1))\n\n    on_update = Seq([\n        Assert(Txn.sender() == App.globalGet(creator_key)),\n        Return(Int(1))\n    ])\n\n    on_delete = Seq([\n        Assert(Txn.sender() == App.globalGet(creator_key)),\n        Return(Int(1))\n    ])\n\n    on_transfer = Seq([\n        Assert(\n            And(\n                Txn.group_index() == Int(1),\n                Gtxn[0].type_enum() == TxnType.AssetTransfer,\n                Gtxn[1].type_enum() == TxnType.ApplicationCall,\n                Gtxn[0].xfer_asset() == Gtxn[1].assets[0],\n                Gtxn[0].asset_amount() >= min_amount\n            )\n        ),\n        App.globalPut(Concat(key_prefix, Txn.accounts[1]), Gtxn[0].asset_amount()),\n        Approve()\n    ])\n\n    on_check = Seq([\n        Assert(Txn.application_args.length() == Int(1)),\n        Return(App.globalGet(Concat(key_prefix, Txn.accounts[1])) > Int(0))\n    ])\n\n    program = Cond(\n        [Txn.application_id() == Int(0), on_creation],\n        [Txn.on_completion() == OnComplete.OptIn, on_optin],\n        [Txn.on_completion() == OnComplete.CloseOut, on_closeout],\n        [Txn.on_completion() == OnComplete.UpdateApplication, on_update],\n        [Txn.on_completion() == OnComplete.DeleteApplication, on_delete],\n        [Txn.on_completion() == OnComplete.NoOp, Cond(\n            [Txn.application_args[0] == Bytes(\"transfer\"), on_transfer],\n            [Txn.application_args[0] == Bytes(\"check\"), on_check]\n        )]\n    )\n\n    return program\n\ndef clear_state():\n    return Return(Int(1))\n\nif __name__ == \"__main__\":\n    print(compileTeal(asset_management_contract(), mode=Mode.Application, version=5))\n"}
