{"vulnerability":"arbitrary_update","smart_contract":"from pyteal import *\n\ndef multi_transaction_contract():\n    admin_key = Bytes(\"Admin\")\n    transaction_count_key = Bytes(\"TransactionCount\")\n\n   \n    initialize_application = Seq([\n        App.globalPut(admin_key, Txn.sender()),\n        App.globalPut(transaction_count_key, Int(0)),\n        Approve()\n    ])\n\n   \n    handle_operation = Seq([\n        Assert(\n            And(\n                Global.group_size() == Int(3),  \n                Gtxn[0].type_enum() == TxnType.Payment,  \n                Gtxn[1].type_enum() == TxnType.ApplicationCall,  \n                Gtxn[2].type_enum() == TxnType.Payment,  \n                Gtxn[1].application_args[0] == Bytes(\"execute_operation\")  \n            )\n        ),\n        App.globalPut(transaction_count_key, App.globalGet(transaction_count_key) + Int(1)),\n        Approve()\n    ])\n\n    \n    update_admin = Seq([\n        Assert(\n            And(\n                Txn.application_args.length() == Int(2),  \n\n                Txn.on_completion() == OnComplete.UpdateApplication\n            )\n        ),\n        App.globalPut(admin_key, Txn.application_args[1]),\n        Approve()\n    ])\n\n    \n    delete_application = Seq([\n        Assert(Txn.sender() == App.globalGet(admin_key)),\n        Approve()\n    ])\n\n    \n    program = Cond(\n        [Txn.application_id() == Int(0), initialize_application],\n        [Txn.on_completion() == OnComplete.NoOp, Cond(\n            [Txn.application_args[0] == Bytes(\"execute_operation\"), handle_operation]\n        )],\n        [Txn.on_completion() == OnComplete.UpdateApplication, update_admin],\n        [Txn.on_completion() == OnComplete.DeleteApplication, delete_application]\n    )\n\n    return program\n\nif __name__ == \"__main__\":\n    compiled = compileTeal(multi_transaction_contract(), mode=Mode.Application, version=5)\n    print(compiled)\n"}
